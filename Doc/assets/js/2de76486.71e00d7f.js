"use strict";(self.webpackChunkmodio_docs=self.webpackChunkmodio_docs||[]).push([[1025],{65484:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var t=i(74848),r=i(28453);const o={id:"ue-initialization",title:"Initialization",slug:"/unreal/initialization"},s="Initialization",a={id:"getting-started/ue-initialization",title:"Initialization",description:"This guide describes the mod.io Unreal Engine plugin's basic event loop, initialization, and shutdown functions.",source:"@site/public/en-us/getting-started/ue-initialization.mdx",sourceDirName:"getting-started",slug:"/unreal/initialization",permalink:"/unreal/initialization",draft:!1,unlisted:!1,editUrl:"https://github.com/modio/modio-docs/tree/main/public/en-us/getting-started/ue-initialization.mdx",tags:[],version:"current",frontMatter:{id:"ue-initialization",title:"Initialization",slug:"/unreal/initialization"},sidebar:"sidebar",previous:{title:"Installation",permalink:"/unreal/installation"},next:{title:"Android Configuration",permalink:"/unreal/android-configuration"}},l={},d=[{value:"Calling RunPendingHandlers",id:"calling-runpendinghandlers",level:2},{value:"Initialization process",id:"initialization-process",level:2},{value:"Shutdown process",id:"shutdown-process",level:2},{value:"Next steps",id:"next-steps",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{TabItem:o,Tabs:s}=n;return o||h("TabItem",!0),s||h("Tabs",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"initialization",children:"Initialization"}),"\n",(0,t.jsx)(n.p,{children:"This guide describes the mod.io Unreal Engine plugin's basic event loop, initialization, and shutdown functions."}),"\n",(0,t.jsxs)(n.p,{children:["Ideally, you should wrap these functions in a separate subsystem (e.g. ",(0,t.jsx)(n.code,{children:"ModioManagerSubsystem"}),") which is responsible for managing the full initialization and authentication flow for your game."]}),"\n",(0,t.jsx)(n.p,{children:"This guide covers:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#calling-runpendinghandlers",children:"Calling RunPendingHandlers"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#initialization-process",children:"Initialization process"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#shutdown-process",children:"Shutdown process"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"calling-runpendinghandlers",children:"Calling RunPendingHandlers"}),"\n",(0,t.jsxs)(n.p,{children:["Before initializing the plugin, ensure ",(0,t.jsx)(n.a,{href:"/unreal/refdocs/#run-pending-handlers",children:(0,t.jsx)(n.code,{children:"RunPendingHandlers"})})," is being continually called. You can do this yourself in your project\u2019s main loop, or by setting ",(0,t.jsx)(n.a,{href:"/unreal/installation/#using-a-background-thread",children:(0,t.jsx)(n.code,{children:"Use Background Thread"})})," to true in the mod.io project settings.  For best performance, ",(0,t.jsx)(n.code,{children:"RunPendingHandlers"})," should be called at least once per frame. See ",(0,t.jsx)(n.a,{href:"/unreal/plugin-structure/#maintaining-the-plugin-event-loop",children:"Maintaining the plugin event loop"})," for additional information."]}),"\n",(0,t.jsx)(n.h2,{id:"initialization-process",children:"Initialization process"}),"\n",(0,t.jsxs)(n.p,{children:["The mod.io Unreal Engine plugin is initialized by calling ",(0,t.jsx)(n.a,{href:"/unreal/refdocs/#initializeasync",children:(0,t.jsx)(n.code,{children:"InitializeAsync"})}),", passing in a ",(0,t.jsx)(n.a,{href:"/unreal/refdocs/#modioinitializeoptions",children:(0,t.jsx)(n.code,{children:"ModioInitializeOptions"})})," with the relevant information for the current session, and a callback containing a ",(0,t.jsx)(n.a,{href:"/unreal/refdocs/#modioerrorcode",children:(0,t.jsx)(n.code,{children:"ModioErrorCode"})})," that will contain the result of the initialization on completion."]}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.a,{href:"/unreal/refdocs/#get-project-initialize-options-for-session-id",children:(0,t.jsx)(n.code,{children:"GetProjectInitializeOptionsForSessionId"})})," to initialize the plugin using the information entered in the ",(0,t.jsx)(n.a,{href:"/unreal/installation/#plugin-configuration",children:"mod.io project settings"}),".  You should use ",(0,t.jsx)(n.code,{children:"FPlatformProcess::UserName()"})," to get a default username for the ",(0,t.jsx)(n.a,{href:"/unreal/plugin-structure/#user-sessions",children:"Session ID"}),".  Some platforms also require additional parameters added to ",(0,t.jsx)(n.code,{children:"ModioInitializeOptions.ExtendedInitializationParameters"}),".  Refer to the relevant ",(0,t.jsx)(n.a,{href:"https://docs.mod.io/getting-started/#expand-with-cross-platform-functionality",children:"platform documentation"})," for more information."]}),"\n",(0,t.jsxs)(n.p,{children:["The plugin also provides a set of helper functions in ",(0,t.jsx)(n.code,{children:"UModioPlatformHelpersLibrary"})," to facilitate setting up platform and portal configurations. You can use ",(0,t.jsx)(n.a,{href:"/unreal/refdocs/#get-default-portal-for-current-platform",children:(0,t.jsx)(n.code,{children:"GetDefaultPortalForCurrentPlatform"})})," to get the appropriate default portal for the current platform, which you can then set in ",(0,t.jsx)(n.code,{children:"ModioInitializeOptions.PortalInUse"}),"."]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"GetDefaultPortalForCurrentPlatform"})," will return ",(0,t.jsx)(n.code,{children:"EModioPortal::Steam"})," as the default portal on PC platforms. If you are using a different portal, you should set this value explicitly."]})}),"\n",(0,t.jsxs)(s,{groupId:"languages",children:[(0,t.jsxs)(o,{value:"blueprint",label:"Blueprint",children:[(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"run_pending_handlers",src:i(84218).A+"",width:"1120",height:"448"})}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"initasync_getoptions",src:i(628).A+"",width:"1040",height:"486"})})]}),(0,t.jsx)(o,{value:"cpp",label:"C++",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'void UModioManagerSubsystem::Init()\r\n{\t\r\n   if (UModioSubsystem* Subsystem = GEngine->GetEngineSubsystem<UModioSubsystem>())\r\n   {\r\n   \tFModioInitializeOptions Options = UModioSDKLibrary::GetProjectInitializeOptionsForSessionId(FPlatformProcess::UserName())\r\n\r\n   \tOptions.PortalInUse = UModioPlatformHelpersLibrary::GetDefaultPortalForCurrentPlatform();\r\n   \tSubsystem->InitializeAsync(Options, FOnErrorOnlyDelegateFast::CreateUObject(this, &UModioManagerSubsystem::OnInitCallback));\r\n   }\r\n   UE_LOG(LogModioGame, Log, TEXT("Initializing mod.io"));\r\n}\r\n\r\nvoid UModioManagerSubsystem::OnInitCallback(FModioErrorCode ErrorCode)\r\n{\r\n   UE_LOG(LogModioGame, Log, TEXT("mod.io initialization complete with result: %s"), *ErrorCode.GetErrorMessage());\r\n}\r\n\r\nvoid UModioManagerSubsystem::Tick(float DeltaTime)\r\n{\r\n   if (UModioSubsystem* Subsystem = GEngine->GetEngineSubsystem<UModioSubsystem>())\r\n   {\r\n   \tSubsystem->RunPendingHandlers();\r\n   }\r\n}\n'})})})]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The error-handling in this sample has been omitted. See our ",(0,t.jsx)(n.a,{href:"/unreal/plugin-structure/#error-handling",children:"Error handling"})," section in the Plugin Structure guide for more."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"InitializeAsync"})," is an asynchronous function, therefore you must wait for the callback for confirmation that the initialization is complete."]}),"\n"]})}),"\n",(0,t.jsx)(n.h2,{id:"shutdown-process",children:"Shutdown process"}),"\n",(0,t.jsxs)(n.p,{children:["The mod.io Unreal Engine plugin is shut down by calling ",(0,t.jsx)(n.a,{href:"/unreal/refdocs#shutdownasync",children:(0,t.jsx)(n.code,{children:"ShutdownAsync"})})," in a similar fashion."]}),"\n",(0,t.jsxs)(s,{groupId:"languages",children:[(0,t.jsx)(o,{value:"blueprint",label:"Blueprint",children:(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"shutdownasync_runhandlers",src:i(7744).A+"",width:"840",height:"389"})})}),(0,t.jsx)(o,{value:"cpp",label:"C++",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'void UModioManagerSubsystem::Shutdown()\r\n{\r\n   if (UModioSubsystem* Subsystem = GEngine->GetEngineSubsystem<UModioSubsystem>())\r\n   {\r\n   \tSubsystem->ShutdownAsync(FOnErrorOnlyDelegateFast::CreateUObject(this, &UModioManagerSubsystem::OnShutdownComplete));\r\n   }\r\n}\r\n\r\nvoid UModioManagerSubsystem::OnShutdownComplete(FModioErrorCode ErrorCode)\r\n{\r\n   UE_LOG(LogModioGame, Log, TEXT("Shutdown complete with result: %s"), *ErrorCode.GetErrorMessage());\r\n}\n'})})})]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["You must continue to call ",(0,t.jsx)(n.a,{href:"/unreal/refdocs/#run-pending-handlers",children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"RunPendingHandlers"})})})," while shutdown is in progress to allow intermediate handlers to complete."]}),"\n",(0,t.jsx)(n.li,{children:"Any in-flight mod.io async calls will complete with an error code indicating cancellation."}),"\n",(0,t.jsxs)(n.li,{children:["You ",(0,t.jsx)(n.em,{children:"must not"})," call ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"ShutdownAsync"})})," from within another completion handler/callback. This may cause the application to deadlock."]}),"\n"]})}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,t.jsxs)(n.p,{children:["Now that you have set up the Unreal Engine Plugin, you may want to learn more about the ",(0,t.jsx)(n.a,{href:"/unreal/plugin-structure/",children:"Plugin Structure"})," to get a better understanding of the plugin itself and processes such error handling and user sessions."]}),"\n",(0,t.jsxs)(n.p,{children:["Or if you are eager to get things moving, you can skip directly to setting up ",(0,t.jsx)(n.a,{href:"/unreal/user-authentication",children:"User Authentication"})," or ",(0,t.jsx)(n.a,{href:"/unreal/searching-ugc",children:"Searching for UGC"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["All other core setup information can be found in the ",(0,t.jsx)(n.a,{href:"/unreal/#unreal-engine-core-plugin-guides",children:"Unreal Getting Started Guides"}),", which are designed to teach you how to implement the fundamentals of the Unreal Engine Plugin."]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}function h(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},628:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/initasync_getoptions-360a1e993f60ae95a6669d05089b8a90.png"},84218:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/run_pending_handlers-efe6d4d7cf284151f4edefca851e62c7.png"},7744:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/shutdownasync_runhandlers-3191ba44852c75227048e845dab1ccc2.png"},28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>a});var t=i(96540);const r={},o=t.createContext(r);function s(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);